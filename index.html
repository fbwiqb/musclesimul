<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Í∑ºÏú° ÏàòÏ∂ï Ïä¨ÎùºÏù¥Îî© ÌïÑÎùºÎ©òÌä∏ ÏãúÎÆ¨Î†àÏù¥ÌÑ∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #0066cc 0%, #004999 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 32px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .header {
            text-align: center;
            margin-bottom: 24px;
        }
        
        h2 {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 12px;
            color: #0066cc;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            background: #0066cc;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }
        
        .btn:hover {
            background: #0052a3;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,102,204,0.3);
        }
        
        .control-panel {
            background: #f0f7ff;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 24px;
            border: 2px solid #0066cc;
        }
        
        .control-label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 18px;
            color: #0066cc;
        }
        
        .length-value {
            color: #0066cc;
            font-size: 22px;
            font-weight: bold;
        }
        
        .delta-display {
            color: #666;
            font-size: 16px;
            margin-left: 8px;
        }
        
        input[type="range"] {
            width: 100%;
            height: 8px;
            -webkit-appearance: none;
            appearance: none;
            background: #cce5ff;
            border-radius: 4px;
            outline: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: #0066cc;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,102,204,0.5);
        }
        
        input[type="range"]::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: #0066cc;
            border-radius: 50%;
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 8px rgba(0,102,204,0.5);
        }
        
        .range-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
            font-size: 12px;
            color: #666;
        }
        
        .svg-container {
            background: white;
            border: 2px solid #0066cc;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 24px;
            overflow-x: auto;
        }
        
        svg {
            display: block;
            margin: 0 auto;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
            margin-bottom: 32px;
        }
        
        .info-card {
            background: #f0f7ff;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #0066cc;
        }
        
        .info-card h4 {
            font-weight: bold;
            margin-bottom: 12px;
            color: #0066cc;
        }
        
        .info-card ul {
            list-style: disc;
            margin-left: 20px;
            line-height: 1.8;
        }
        
        .delta-positive {
            color: #28a745;
        }
        
        .delta-negative {
            color: #dc3545;
        }
        
        .delta-info {
            color: #0066cc;
        }
        
        .calculator {
            background: #f0f7ff;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #0066cc;
            margin-bottom: 32px;
        }
        
        .calculator h4 {
            font-weight: bold;
            margin-bottom: 16px;
            color: #0066cc;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }
        
        th, td {
            border: 1px solid #0066cc;
            padding: 12px;
            text-align: left;
        }
        
        th {
            background: #0066cc;
            color: white;
            font-weight: 600;
        }
        
        td:nth-child(4) {
            text-align: center;
            font-weight: bold;
        }
        
        select {
            width: 100%;
            padding: 6px;
            border-radius: 4px;
            border: 2px solid #0066cc;
            font-size: 14px;
        }
        
        .operator-select {
            width: 100%;
            padding: 6px;
            border-radius: 4px;
            border: 2px solid #0066cc;
            font-size: 16px;
            font-weight: bold;
            text-align: center;
            background: #f0f7ff;
        }
        
        footer {
            margin-top: 40px;
            padding: 20px;
            background: #f0f7ff;
            border-radius: 8px;
            border: 2px solid #0066cc;
            text-align: center;
        }
        
        .footer-content {
            margin-bottom: 10px;
            color: #333;
        }
        
        .developer-log {
            font-size: 12px;
            color: #666;
            margin-top: 8px;
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border: 2px solid #0066cc;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #0066cc;
        }
        
        .modal-header h3 {
            color: #0066cc;
            font-size: 24px;
        }
        
        .close {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .close:hover {
            color: #0066cc;
        }
        
        .modal-content h4 {
            color: #0066cc;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        
        .modal-content ul {
            margin-left: 20px;
            line-height: 1.8;
        }
        
        .modal-content p {
            line-height: 1.6;
            margin-bottom: 10px;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 16px;
            }
            
            .info-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }
            
            .svg-container {
                padding: 10px;
            }
            
            h2 {
                font-size: 22px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .modal-content {
                width: 95%;
                margin: 10% auto;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h2>ü¶¥ Í∑ºÏú° ÏàòÏ∂ï Ïä¨ÎùºÏù¥Îî© ÌïÑÎùºÎ©òÌä∏ ÏãúÎÆ¨Î†àÏù¥ÌÑ∞</h2>
            <div class="button-group">
                <button class="btn" onclick="openModal('usage')">üìñ ÏÇ¨Ïö©Î≤ï</button>
                <button class="btn" onclick="openModal('devlog')">üíª Í∞úÎ∞úÏûê Î°úÍ∑∏</button>
            </div>
        </div>
        
        <div class="control-panel">
            <label class="control-label">
                Í∑ºÏ†à Í∏∏Ïù¥: <span class="length-value" id="lengthDisplay">4.50 Œºm</span>
                <span class="delta-display" id="deltaDisplay">(Í∏∞Ï§ÄÍ∞í)</span>
            </label>
            <input type="range" id="sarcomereSlider" min="0" max="20" step="1" value="10">
            <div class="range-labels">
                <span>5.4 Œºm (Ïù¥ÏôÑ)</span>
                <span>5.0 Œºm</span>
                <span>4.5 Œºm (Í∏∞Ï§Ä)</span>
                <span>4.0 Œºm</span>
                <span>3.6 Œºm (ÏàòÏ∂ï)</span>
            </div>
        </div>

        <div class="svg-container">
            <svg id="muscleSvg" width="820" height="300"></svg>
        </div>

        <div class="info-grid">
            <div class="info-card">
                <h4>üìè Î≥ÄÌïòÏßÄ ÏïäÎäî Í∏∏Ïù¥</h4>
                <ul>
                    <li>AÎåÄ Í∏∏Ïù¥: <strong>1.80 Œºm</strong></li>
                    <li>ÎßàÏù¥Ïò§Ïã†: <strong>1.80 Œºm</strong></li>
                    <li>Ïï°Ìã¥: <strong>1.80 Œºm</strong></li>
                </ul>
            </div>
            
            <div class="info-card">
                <h4>üìä Í∏∏Ïù¥ Î≥ÄÌôî (ÏàòÏ∂ïÏóê Îî∞Îùº Î≥ÄÌï®)</h4>
                <ul id="changesList"></ul>
            </div>
        </div>

        <div class="calculator">
            <h4>üî¢ Í∏∏Ïù¥ Ï°∞Ìï© Í≥ÑÏÇ∞Í∏∞</h4>
            <table>
                <thead>
                    <tr>
                        <th>ÏÑ†ÌÉù 1</th>
                        <th>Ïó∞ÏÇ∞</th>
                        <th>ÏÑ†ÌÉù 2</th>
                        <th>Í≤∞Í≥º (Œºm)</th>
                    </tr>
                </thead>
                <tbody id="calculatorTable"></tbody>
            </table>
        </div>

        <footer>
            <div class="footer-content">
                <strong>¬© 2025 Í∑ºÏú° ÏàòÏ∂ï ÏãúÎÆ¨Î†àÏù¥ÌÑ∞</strong><br>
                Ï∂©ÎÇ®ÏÇºÏÑ±Í≥†Îì±ÌïôÍµê ÏÉùÎ™ÖÍ≥ºÌïô ÍµêÏú°Ïö© ÏãúÎÆ¨Î†àÏù¥ÏÖò ÌîÑÎ°úÍ∑∏Îû®
            </div>
            <div class="developer-log">
                Í∞úÎ∞ú: Ïã†ÎèÑÍ≤Ω | ÏµúÏ¢Ö ÏóÖÎç∞Ïù¥Ìä∏: 2025.01 | Version 1.0
            </div>
        </footer>
    </div>

    <!-- ÏÇ¨Ïö©Î≤ï Î™®Îã¨ -->
    <div id="usageModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üìñ ÏÇ¨Ïö©Î≤ï</h3>
                <span class="close" onclick="closeModal('usage')">&times;</span>
            </div>
            <h4>üéØ ÌîÑÎ°úÍ∑∏Îû® ÏÜåÍ∞ú</h4>
            <p>Ïù¥ ÏãúÎÆ¨Î†àÏù¥ÌÑ∞Îäî Í∑ºÏú° ÏàòÏ∂ï Ïãú Ïä¨ÎùºÏù¥Îî© ÌïÑÎùºÎ©òÌä∏ Ïù¥Î°†Ïóê Îî∞Î•∏ Í∞Å Î∂ÄÏúÑÏùò Í∏∏Ïù¥ Î≥ÄÌôîÎ•º ÏãúÍ∞ÅÏ†ÅÏúºÎ°ú Î≥¥Ïó¨Ï§çÎãàÎã§.</p>
            
            <h4>üéÆ Ï°∞Ïûë Î∞©Î≤ï</h4>
            <ul>
                <li><strong>Ïä¨ÎùºÏù¥Îçî Ï°∞Ï†à:</strong> Í∑ºÏ†à Í∏∏Ïù¥Î•º 5.4 Œºm (Ïù¥ÏôÑ)ÏóêÏÑú 3.6 Œºm (ÏàòÏ∂ï)ÍπåÏßÄ Ï°∞Ï†àÌï† Ïàò ÏûàÏäµÎãàÎã§.</li>
                <li><strong>Í∏∞Ï§ÄÍ∞í:</strong> 4.5 ŒºmÏùÑ Í∏∞Ï§ÄÏúºÎ°ú ÏÑ§Ï†ïÎêòÏñ¥ ÏûàÏúºÎ©∞, Ïù¥Î•º Í∏∞Ï§ÄÏúºÎ°ú Î≥ÄÌôîÎüâÏù¥ ÌëúÏãúÎê©ÎãàÎã§.</li>
            </ul>
            
            <h4>üìä ÌôîÎ©¥ Íµ¨ÏÑ±</h4>
            <ul>
                <li><strong>SVG Îã§Ïù¥Ïñ¥Í∑∏Îû®:</strong> Ïï°Ìã¥(ÌååÎûÄÏÉâ), ÎßàÏù¥Ïò§Ïã†(Îπ®Í∞ÑÏÉâ), ZÏÑ†, MÏÑ†, AÎåÄ, HÎåÄ, IÎåÄÎ•º ÏãúÍ∞ÅÌôîÌï©ÎãàÎã§.</li>
                <li><strong>Î≥ÄÌïòÏßÄ ÏïäÎäî Í∏∏Ïù¥:</strong> AÎåÄ, ÎßàÏù¥Ïò§Ïã†, Ïï°Ìã¥ ÌïÑÎùºÎ©òÌä∏Ïùò Í∏∏Ïù¥Îäî Ìï≠ÏÉÅ 1.80 ŒºmÎ°ú ÏùºÏ†ïÌï©ÎãàÎã§.</li>
                <li><strong>Í∏∏Ïù¥ Î≥ÄÌôî:</strong> HÎåÄ, IÎåÄ, Í≤πÏπòÎäî Íµ¨Í∞ÑÏùò Í∏∏Ïù¥Í∞Ä ÏàòÏ∂ï Ï†ïÎèÑÏóê Îî∞Îùº Î≥ÄÌï©ÎãàÎã§.</li>
                <li><strong>Í∏∏Ïù¥ Ï°∞Ìï© Í≥ÑÏÇ∞Í∏∞:</strong> Îëê ÏöîÏÜåÎ•º ÏÑ†ÌÉùÌïòÍ≥† Ïó∞ÏÇ∞(+, ‚àí, √ó, √∑)ÏùÑ ÏÑ†ÌÉùÌïòÏó¨ Í≤∞Í≥ºÎ•º Í≥ÑÏÇ∞Ìï† Ïàò ÏûàÏäµÎãàÎã§.
                    <ul>
                        <li>ÎçîÌïòÍ∏∞(+): Îëê Í∏∏Ïù¥Ïùò Ìï©Í≥º Í∏∞Ï§ÄÍ∞í ÎåÄÎπÑ Î≥ÄÌôîÎüâ(Œî) ÌëúÏãú</li>
                        <li>ÎπºÍ∏∞(‚àí): Ï≤´ Î≤àÏß∏ Í∞íÏóêÏÑú Îëê Î≤àÏß∏ Í∞íÏùÑ Î∫Ä Í≤∞Í≥º</li>
                        <li>Í≥±ÌïòÍ∏∞(√ó): Îëê Í∞íÏùò Í≥±</li>
                        <li>ÎÇòÎàÑÍ∏∞(√∑): Ï≤´ Î≤àÏß∏ Í∞íÏùÑ Îëê Î≤àÏß∏ Í∞íÏúºÎ°ú ÎÇòÎàà ÎπÑÏú®</li>
                    </ul>
                </li>
            </ul>
            
            <h4>üìö ÌïôÏäµ Ìè¨Ïù∏Ìä∏</h4>
            <ul>
                <li>Í∑ºÏú° ÏàòÏ∂ï Ïãú AÎåÄ Í∏∏Ïù¥Îäî Î≥ÄÌïòÏßÄ ÏïäÏäµÎãàÎã§.</li>
                <li>HÎåÄÏôÄ IÎåÄÎäî ÏàòÏ∂ïÌï†ÏàòÎ°ù ÏßßÏïÑÏßëÎãàÎã§.</li>
                <li>Ïï°Ìã¥Í≥º ÎßàÏù¥Ïò§Ïã†Ïù¥ Í≤πÏπòÎäî Íµ¨Í∞ÑÏùÄ ÏàòÏ∂ïÌï†ÏàòÎ°ù Í∏∏Ïñ¥ÏßëÎãàÎã§.</li>
                <li>ÏôÑÏ†Ñ ÏàòÏ∂ï Ïãú (3.6 Œºm) HÎåÄÍ∞Ä ÏÇ¨ÎùºÏßÄÍ≥† Ïï°Ìã¥Ïù¥ MÏÑ†Ïóê ÎãøÍ≤å Îê©ÎãàÎã§.</li>
            </ul>
        </div>
    </div>

    <!-- Í∞úÎ∞úÏûê Î°úÍ∑∏ Î™®Îã¨ -->
    <div id="devlogModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üíª Í∞úÎ∞úÏûê Î°úÍ∑∏</h3>
                <span class="close" onclick="closeModal('devlog')">&times;</span>
            </div>
            
            <h4>üìå Version 1.0 (2025.01)</h4>
            <ul>
                <li>‚úÖ Í∑ºÏ†à Í∏∏Ïù¥ Ïä¨ÎùºÏù¥Îçî Í∏∞Îä• Íµ¨ÌòÑ</li>
                <li>‚úÖ SVG Í∏∞Î∞ò Ïã§ÏãúÍ∞Ñ ÏãúÍ∞ÅÌôî</li>
                <li>‚úÖ Í∏∏Ïù¥ Î≥ÄÌôî ÏûêÎèô Í≥ÑÏÇ∞ Î∞è ÌëúÏãú</li>
                <li>‚úÖ 6Ìñâ Í∏∏Ïù¥ Ï°∞Ìï© Í≥ÑÏÇ∞Í∏∞ (4ÏπôÏó∞ÏÇ∞ ÏßÄÏõê)</li>
                <li>‚úÖ Î∞òÏùëÌòï ÎîîÏûêÏù∏ Ï†ÅÏö©</li>
                <li>‚úÖ Í∏∞Ï§ÄÍ∞í(4.5 Œºm) Í∏∞Î∞ò Î≥ÄÌôîÎüâ ÌëúÏãú</li>
                <li>‚úÖ Ïó∞ÏÇ∞Ïûê ÏÑ†ÌÉù Í∏∞Îä• (+, ‚àí, √ó, √∑)</li>
            </ul>
            
            <h4>üéì ÍµêÏú° Î™©Ï†Å</h4>
            <p>Ï∂©ÎÇ®ÏÇºÏÑ±Í≥†Îì±ÌïôÍµê ÏÉùÎ™ÖÍ≥ºÌïô ÏàòÏóÖÏùÑ ÏúÑÌï¥ Í∞úÎ∞úÎêòÏóàÏúºÎ©∞, Ïä¨ÎùºÏù¥Îî© ÌïÑÎùºÎ©òÌä∏ Ïù¥Î°†ÏùÑ ÏßÅÍ¥ÄÏ†ÅÏúºÎ°ú Ïù¥Ìï¥Ìï† Ïàò ÏûàÎèÑÎ°ù ÏÑ§Í≥ÑÎêòÏóàÏäµÎãàÎã§.</p>
            
            <h4>üìß Î¨∏Ïùò</h4>
            <p>Í∞úÎ∞úÏûê: Ïã†ÎèÑÍ≤Ω (Ï∂©ÎÇ®ÏÇºÏÑ±Í≥†Îì±ÌïôÍµê)<br>
            Î∏îÎ°úÍ∑∏: Standbio</p>
        </div>
    </div>

    <script>
        // ÏÉÅÏàò Ï†ïÏùò
        const umToPx = (um) => um / (5.0 / 700);
        const aBandUm = 1.8;
        const iBandUm = 1.8;
        const actinUm = 1.8;
        const actinLength = umToPx(actinUm);
        const myosinLength = umToPx(aBandUm);
        const centerX = (750 + 50) / 2;
        const myosinStart = 270;
        const myosinEnd = myosinStart + myosinLength;
        const baselineSarcomere = 4.5; // Í∏∞Ï§ÄÍ∞í

        // Í∑ºÏ†à Í∏∏Ïù¥ ÌÖåÏù¥Î∏î
        const sarcomereLengthTable = Array.from({ length: 19 }, (_, i) => 5.4 - i * 0.1);

        // ÏÑ†ÌÉù Í∞ÄÎä•Ìïú Í∏∏Ïù¥ ÏòµÏÖò
        const lengthOptions = [
            "AÎåÄ Í∏∏Ïù¥", "ÎßàÏù¥Ïò§Ïã†", "Ïï°Ìã¥", "HÎåÄ Í∏∏Ïù¥", 
            "IÎåÄ Í∏∏Ïù¥", "Í≤πÏπòÎäî Íµ¨Í∞Ñ", "¬Ω IÎåÄ Í∏∏Ïù¥", "¬Ω Í≤πÏπòÎäî Íµ¨Í∞Ñ"
        ];

        // Í∏∞Ï§ÄÍ∞í
        const referenceValues = {
            "HÎåÄ Í∏∏Ïù¥": 1.8,
            "IÎåÄ Í∏∏Ïù¥": 3.6,
            "¬Ω IÎåÄ Í∏∏Ïù¥": 1.8,
            "Í≤πÏπòÎäî Íµ¨Í∞Ñ": 0,
            "¬Ω Í≤πÏπòÎäî Íµ¨Í∞Ñ": 0
        };

        // Í≥ÑÏÇ∞Í∏∞ ÏÉÅÌÉú
        let calculatorRows = Array(6).fill(null).map(() => ["", "+", ""]);

        // Î™®Îã¨ Ï†úÏñ¥
        function openModal(type) {
            document.getElementById(type + 'Modal').style.display = 'block';
        }

        function closeModal(type) {
            document.getElementById(type + 'Modal').style.display = 'none';
        }

        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        }

        // SVG Í∑∏Î¶¨Í∏∞ Ìï®Ïàò
        function drawMuscle(sarcomereUm) {
            const svg = document.getElementById('muscleSvg');
            svg.innerHTML = '';

            const minSarcomereUm = 2 * actinUm;
            sarcomereUm = Math.max(sarcomereUm, minSarcomereUm);

            const pxToUm = 5.0 / 700;
            const pxLength = sarcomereUm / pxToUm;
            const leftZ = centerX - pxLength / 2;
            const rightZ = centerX + pxLength / 2;

            const hStart = leftZ + actinLength;
            const hEnd = rightZ - actinLength;

            // ZÏÑ†
            svg.innerHTML += `
                <line x1="${leftZ}" y1="80" x2="${leftZ}" y2="220" stroke="#0066cc" stroke-width="4"/>
                <line x1="${rightZ}" y1="80" x2="${rightZ}" y2="220" stroke="#0066cc" stroke-width="4"/>
                <text x="${leftZ}" y="240" font-size="14" text-anchor="middle" fill="#0066cc" font-weight="bold">ZÏÑ†</text>
                <text x="${rightZ}" y="240" font-size="14" text-anchor="middle" fill="#0066cc" font-weight="bold">ZÏÑ†</text>
            `;

            // Ïï°Ìã¥ ÌïÑÎùºÎ©òÌä∏
            [100, 140, 180, 220].forEach(y => {
                svg.innerHTML += `
                    <rect x="${leftZ}" y="${y}" width="${actinLength}" height="6" fill="#4169E1" rx="3"/>
                    <rect x="${rightZ - actinLength}" y="${y}" width="${actinLength}" height="6" fill="#4169E1" rx="3"/>
                `;
            });

            // ÎßàÏù¥Ïò§Ïã† ÌïÑÎùºÎ©òÌä∏
            [120, 160, 200].forEach(y => {
                svg.innerHTML += `<rect x="${myosinStart}" y="${y}" width="${myosinLength}" height="18" fill="#DC143C" rx="4"/>`;
            });

            // MÏÑ†
            const mLineX = (myosinStart + myosinEnd) / 2;
            svg.innerHTML += `
                <line x1="${mLineX}" y1="80" x2="${mLineX}" y2="220" stroke="#FFA500" stroke-width="3" stroke-dasharray="5 5"/>
                <text x="${mLineX}" y="70" font-size="14" text-anchor="middle" fill="#FFA500" font-weight="bold">MÏÑ†</text>
            `;

            // AÎåÄ
            svg.innerHTML += `
                <rect x="${myosinStart}" y="40" width="${myosinLength}" height="12" stroke="#333" fill="rgba(220,20,60,0.1)" stroke-dasharray="4 2"/>
                <text x="${mLineX}" y="30" font-size="14" text-anchor="middle" font-weight="bold">AÎåÄ</text>
            `;

            // HÎåÄ
            if (hEnd > hStart) {
                svg.innerHTML += `
                    <rect x="${hStart}" y="250" width="${hEnd - hStart}" height="12" stroke="#4169E1" fill="rgba(65,105,225,0.1)" stroke-dasharray="4 2"/>
                    <text x="${(hStart + hEnd) / 2}" y="280" font-size="14" text-anchor="middle" fill="#4169E1" font-weight="bold">HÎåÄ</text>
                `;
            }

            // IÎåÄ
            if (myosinStart > leftZ) {
                svg.innerHTML += `
                    <rect x="${leftZ}" y="270" width="${myosinStart - leftZ}" height="12" stroke="#DC143C" fill="rgba(220,20,60,0.1)" stroke-dasharray="4 2"/>
                    <text x="${(leftZ + myosinStart) / 2}" y="295" font-size="12" text-anchor="middle" fill="#DC143C">¬Ω IÎåÄ</text>
                `;
            }
            if (rightZ > myosinEnd) {
                svg.innerHTML += `
                    <rect x="${myosinEnd}" y="270" width="${rightZ - myosinEnd}" height="12" stroke="#DC143C" fill="rgba(220,20,60,0.1)" stroke-dasharray="4 2"/>
                    <text x="${(rightZ + myosinEnd) / 2}" y="295" font-size="12" text-anchor="middle" fill="#DC143C">¬Ω IÎåÄ</text>
                `;
            }
        }

        // Í∏∏Ïù¥ Í≥ÑÏÇ∞
        function calculateLengths(sarcomereUm) {
            const contractionUm = 5.4 - sarcomereUm;
            const hBandUm = Math.max(0, 1.8 - contractionUm);
            const iBandUmCurrent = Math.max(0, sarcomereUm - aBandUm);
            const iHalfBandUm = iBandUmCurrent / 2;
            const overlapUm = contractionUm;

            return {
                "AÎåÄ Í∏∏Ïù¥": aBandUm,
                "ÎßàÏù¥Ïò§Ïã†": aBandUm,
                "Ïï°Ìã¥": actinUm,
                "HÎåÄ Í∏∏Ïù¥": hBandUm,
                "IÎåÄ Í∏∏Ïù¥": 2 * iHalfBandUm,
                "Í≤πÏπòÎäî Íµ¨Í∞Ñ": overlapUm,
                "¬Ω IÎåÄ Í∏∏Ïù¥": iHalfBandUm,
                "¬Ω Í≤πÏπòÎäî Íµ¨Í∞Ñ": overlapUm / 2
            };
        }

        // Î≥ÄÌôî Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏
        function updateChanges(lengths) {
            const changesList = document.getElementById('changesList');
            const items = [
                { name: "HÎåÄ Í∏∏Ïù¥", value: lengths["HÎåÄ Í∏∏Ïù¥"], ref: 1.8 },
                { name: "IÎåÄ Í∏∏Ïù¥", value: lengths["IÎåÄ Í∏∏Ïù¥"], ref: 3.6 },
                { name: "Í≤πÏπòÎäî Íµ¨Í∞Ñ", value: lengths["Í≤πÏπòÎäî Íµ¨Í∞Ñ"], ref: 0 },
                { name: "¬Ω IÎåÄ Í∏∏Ïù¥", value: lengths["¬Ω IÎåÄ Í∏∏Ïù¥"], ref: 1.8 },
                { name: "¬Ω Í≤πÏπòÎäî Íµ¨Í∞Ñ", value: lengths["¬Ω Í≤πÏπòÎäî Íµ¨Í∞Ñ"], ref: 0 }
            ];

            changesList.innerHTML = items.map(item => {
                const delta = item.value - item.ref;
                const deltaClass = delta < 0 ? 'delta-negative' : delta > 0 ? 'delta-positive' : 'delta-info';
                return `<li>${item.name}: <strong>${item.value.toFixed(2)} Œºm</strong> <span class="${deltaClass}">(Œî ${delta.toFixed(2)} Œºm)</span></li>`;
            }).join('');
        }

        // Í≥ÑÏÇ∞Í∏∞ ÌÖåÏù¥Î∏î ÏÉùÏÑ±
        function createCalculatorTable() {
            const table = document.getElementById('calculatorTable');
            table.innerHTML = '';

            for (let i = 0; i < 6; i++) {
                const row = document.createElement('tr');
                
                // ÏÑ†ÌÉù 1
                const select1 = document.createElement('select');
                select1.innerHTML = '<option value="">ÏÑ†ÌÉù Ïïà Ìï®</option>' + 
                    lengthOptions.map(opt => `<option value="${opt}">${opt}</option>`).join('');
                select1.value = calculatorRows[i][0];
                select1.onchange = () => {
                    calculatorRows[i][0] = select1.value;
                    updateCalculator();
                };

                // Ïó∞ÏÇ∞Ïûê ÏÑ†ÌÉù
                const selectOp = document.createElement('select');
                selectOp.className = 'operator-select';
                selectOp.innerHTML = `
                    <option value="+">+</option>
                    <option value="-">‚àí</option>
                    <option value="*">√ó</option>
                    <option value="/">√∑</option>
                `;
                selectOp.value = calculatorRows[i][1];
                selectOp.onchange = () => {
                    calculatorRows[i][1] = selectOp.value;
                    updateCalculator();
                };

                // ÏÑ†ÌÉù 2
                const select2 = document.createElement('select');
                select2.innerHTML = '<option value="">ÏÑ†ÌÉù Ïïà Ìï®</option>' + 
                    lengthOptions.map(opt => `<option value="${opt}">${opt}</option>`).join('');
                select2.value = calculatorRows[i][2];
                select2.onchange = () => {
                    calculatorRows[i][2] = select2.value;
                    updateCalculator();
                };

                const td1 = document.createElement('td');
                td1.appendChild(select1);
                const td2 = document.createElement('td');
                td2.appendChild(selectOp);
                const td3 = document.createElement('td');
                td3.appendChild(select2);
                const td4 = document.createElement('td');
                td4.id = `calc-result-${i}`;

                row.appendChild(td1);
                row.appendChild(td2);
                row.appendChild(td3);
                row.appendChild(td4);
                table.appendChild(row);
            }
        }

        // Í≥ÑÏÇ∞Í∏∞ Í≤∞Í≥º ÏóÖÎç∞Ïù¥Ìä∏
        function updateCalculator() {
            const slider = document.getElementById('sarcomereSlider');
            const sarcomereUm = sarcomereLengthTable[slider.value];
            const lengths = calculateLengths(sarcomereUm);

            calculatorRows.forEach((row, idx) => {
                const resultCell = document.getElementById(`calc-result-${idx}`);
                const [key1, operator, key2] = row;
                
                if (!key1 && !key2) {
                    resultCell.textContent = '-';
                } else if (!key1 || !key2) {
                    resultCell.textContent = 'Í∞íÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî';
                    resultCell.style.color = '#999';
                } else {
                    const v1 = lengths[key1] || 0;
                    const v2 = lengths[key2] || 0;
                    let result;
                    let operatorSymbol;
                    
                    switch(operator) {
                        case '+':
                            result = v1 + v2;
                            operatorSymbol = '+';
                            break;
                        case '-':
                            result = v1 - v2;
                            operatorSymbol = '‚àí';
                            break;
                        case '*':
                            result = v1 * v2;
                            operatorSymbol = '√ó';
                            break;
                        case '/':
                            result = v2 !== 0 ? v1 / v2 : 0;
                            operatorSymbol = '√∑';
                            if (v2 === 0) {
                                resultCell.textContent = '0ÏúºÎ°ú ÎÇòÎàå Ïàò ÏóÜÏäµÎãàÎã§';
                                resultCell.style.color = '#dc3545';
                                return;
                            }
                            break;
                        default:
                            result = v1 + v2;
                            operatorSymbol = '+';
                    }
                    
                    // Í∏∞Ï§ÄÍ∞í Í≥ÑÏÇ∞ (ÎçîÌïòÍ∏∞Ïùº ÎïåÎßå Œî ÌëúÏãú)
                    if (operator === '+') {
                        const ref1 = referenceValues[key1] || 0;
                        const ref2 = referenceValues[key2] || 0;
                        const delta = result - (ref1 + ref2);
                        const deltaClass = delta < 0 ? 'delta-negative' : delta > 0 ? 'delta-positive' : '';
                        resultCell.innerHTML = `${result.toFixed(2)} Œºm <span class="${deltaClass}">(Œî ${delta.toFixed(2)} Œºm)</span>`;
                    } else {
                        // Îã§Î•∏ Ïó∞ÏÇ∞ÏùÄ Í≤∞Í≥ºÎßå ÌëúÏãú
                        resultCell.innerHTML = `<strong>${result.toFixed(2)}</strong> ${operator === '/' ? '' : 'Œºm'}`;
                    }
                    resultCell.style.color = '#333';
                }
            });
        }

        // Î©îÏù∏ ÏóÖÎç∞Ïù¥Ìä∏ Ìï®Ïàò
        function update() {
            const slider = document.getElementById('sarcomereSlider');
            const sarcomereUm = sarcomereLengthTable[slider.value];
            const delta = sarcomereUm - baselineSarcomere;
            
            document.getElementById('lengthDisplay').textContent = `${sarcomereUm.toFixed(2)} Œºm`;
            
            // Í∏∞Ï§ÄÍ∞íÍ≥ºÏùò Ï∞®Ïù¥ ÌëúÏãú
            const deltaDisplay = document.getElementById('deltaDisplay');
            if (Math.abs(delta) < 0.01) {
                deltaDisplay.textContent = '(Í∏∞Ï§ÄÍ∞í)';
                deltaDisplay.style.color = '#666';
            } else {
                const sign = delta > 0 ? '+' : '';
                deltaDisplay.textContent = `(${sign}${delta.toFixed(2)} Œºm)`;
                deltaDisplay.style.color = delta > 0 ? '#28a745' : '#dc3545';
            }
            
            drawMuscle(sarcomereUm);
            
            const lengths = calculateLengths(sarcomereUm);
            updateChanges(lengths);
            updateCalculator();
        }

        // Ï¥àÍ∏∞Ìôî
        document.getElementById('sarcomereSlider').addEventListener('input', update);
        createCalculatorTable();
        update();
    </script>
</body>
</html>
